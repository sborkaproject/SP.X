/*!
 * SP.X tiny framework
 *
 * Copyright 2015 Sborka Project
 * Code by Hauts: http://hauts.com
 *
 * https://github.com/SborkaProject/SP.X 
 */
(function(u){function c(a,b,e){return c.create(a,b,e)}var v=u.SP=u.SP||new function(){};if(!v.X||!v.X.create){var q=function(){},n=!0,r=!1,x=!("undefined"===typeof window||!window.chrome),f={nameCounter:0,getName:function(){return"SiteController_"+ ++f.nameCounter},instances:[],cachedExtensions:[],registerInstance:function(a){f.instances.push(a);f.updateInstances()},addExtension:function(a,b){f.cachedExtensions.push({instances:[],method:a,applyArguments:b});f.updateInstances()},updateInstances:function(){for(var a=
f.cachedExtensions.length,b=f.instances.length,e=0;e<a;e++)for(var k=f.cachedExtensions[e],d=0;d<b;d++)f.testAddInstanceExtenstion(f.instances[d],k)},testAddInstanceExtenstion:function(a,b){for(var e=b.instances.length,k=0;k<e;k++)if(a===b.instances[k])return;b.instances.push(a);a[b.method].apply(a,b.applyArguments)},sayHello:function(){if(n)try{if(x){var a="\u262d\u2605\u272a\u272b\u270c\u265a\u265b\u270d\u2622".split(""),b=function(a,b){return"font-size:"+a+"px;color:"+b+";"};window.console.log("%c"+
a[Math.floor(Math.random()*a.length)],b(48,"#DC143C"));window.console.log("%cSborka Project",b(39,"#DC143C"));window.console.log("%cSP.X tiny framework v1.005 [13.11.2015]\n\n",b(14,"#11161F"))}else window.console.log("Sborka Project"),window.console.log("SP.X tiny framework v1.005 [13.11.2015]\n\n");r=!0}catch(e){n=!1}},toUnderscore:function(a){return a.replace(/([A-Z])/g,function(a){return"_"+a.toLowerCase()})},bindDOMReady:function(a){document.addEventListener?document.addEventListener("DOMContentLoaded",
a,!1):document.attachEvent?document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&a()}):f.bindWindowLoad(a);return f},bindWindowLoad:function(a){var b=window.onload;window.onload="function"==typeof window.onload?function(){b&&b();a()}:a;return f},createNamedObject:function(a,b){var e=eval("new function "+a+"(){}"),k;for(k in b)e[k]=b[k];return e}};c.Utils=f.createNamedObject("Utils",{trim:function(a){return a.replace(/^\s+|\s+$/g,"")},isSet:function(a){return"undefined"!=
typeof a&&null!=a},isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)},isArrayLike:function(a){return c.Utils.isArray(a)||c.Utils.isObject(a)&&c.Utils.isNumber(a.length)?!0:!1},isNumber:function(a){return"number"==typeof a&&!isNaN(a)},isFunction:function(a){return"function"==typeof a},isObject:function(a){return"object"==typeof a},isString:function(a){return"string"==typeof a},createNamedObject:function(a,b){return f.createNamedObject(a,b)},testCallback:function(a,b,e){return c.Utils.isFunction(a)?
a.apply(e,b):null},copy:function(a,b){for(var e in a)b[e]=a[e];return b},delegate:function(a,b){return function(){for(var e=arguments.length,k=Array(e),d=0;d<e;d++)k[d]=arguments[d];return b.apply(a,k)}},now:function(){c.Utils.now=window.performance&&window.performance.now?function(){return window.performance.now()}:function(){return+new Date};return c.Utils.now()},extractArrayValues:function(a){if(c.Utils.isArrayLike(a))return a;a=a.replace("  "," ");a=a.split(" ").join("\\");a=a.split(",").join("\\");
a=a.split("\\");for(var b=[],e=a.length,k=0;k<e;k++){var d=a[k];d&&""!=d&&b.push(d)}return b}});c.LogEngine=f.createNamedObject("LogEngine");c.LogEngine.create=function(a,b,e){function k(a,d){x?window.console.log("%c\tSP.X: "+b+a,d):window.console.log(b+a)}function d(b,d){if(e.debug&&n)if(d=g.isSet(d)?d:"color:#999999;font-size:11px;font-style:italic;",r)k(b,d);else try{k(b,d),r=!0}catch(C){n=!1}return a}b=b||"";var g=c.Utils;a.log=function(a){return d(a,"color:#999999;font-size:11px;font-style:italic;")};
a.error=function(a){return d(a,"color:#FF0000;font-size:11px;font-style:italic;")};a.warn=function(a){return d(a,"color:#FF7700;font-size:11px;font-style:italic;")};a.mark=function(a){return d(a,"color:#009900;font-size:11px;font-style:italic;")};return a};c.EventsEngine=f.createNamedObject("EventsEngine");c.EventsEngine.create=function(a,b){function e(a,b){a=d.extractArrayValues(a);for(var e=0,c=a.length;e<c;e++){var h=a[e];k("Disabling event listeners for event type '"+h+"'");var l=g[h];d.isSet(l)||
(l=g[h]=[]);l.disabled=b}}var k=b&&a.log||q,d=c.Utils,g={};a.events=d.createNamedObject("events");a.enableEvents=function(b){e(b,!0);return a};a.disableEvents=function(b){e(b,!1);return a};a.addEventListener=a.on=a.bind=function(b,e,c){b=d.extractArrayValues(b);e={handler:e,context:d.isSet(c)?c:a};c=0;for(var f=b.length;c<f;c++){var h=b[c];k("Add event listener for event type '"+h+"'");var l=g[h];d.isSet(l)||(l=g[h]=[]);l.push(e)}return a};a.addOnceEventListener=a.onOnce=a.once=a.bindOnce=function(b,
d,e){return a.on(b,function(c){d.apply(e,[c]);a.off(b,d)})};a.removeEventListener=a.off=a.unbind=function(b,e){eventTypes=d.extractArrayValues(eventTypes);for(var c=0,f=eventTypes.length;c<f;c++){b=eventTypes[c];k("Remove event listener for event type '"+b+"'");var h=g[b];if(d.isSet(h))for(var l=0,m=h.length;l<m;l++){var p=h[l];d.isSet(p)&&p.handler===e&&h.splice(l,1)}}return a};a.dispatch=function(b,e){b=d.extractArrayValues(b);for(var c=0,f=b.length;c<f;c++){var h=b[c],l=d.copy(e,d.createNamedObject("Event"));
l.type=h;l=[l];k("Dispatch event type '"+h+"'");h=g[h];if(d.isSet(h))for(var m=0,p=h.length;m<p;m++){var t=h[m];d.isSet(t)&&d.testCallback(t.handler,l,t.context)}}return a};a.events.register=function(b,e){b=d.extractArrayValues(b);var c=b.length,g=1<c?"s":"";k("Register event constant"+g+" for type"+g+" '"+b.join("', '")+"'");for(g=0;g<c;g++){var h=b[g],l=f.toUnderscore(h).toUpperCase();a.events[l]=h;e&&(l=h.substr(0,1).toUpperCase()+h.substr(1),a.events["on"+l]=function(b,d){return a.on(h,b,d)},
a.events["off"+l]=function(b){return a.off(h,b)})}return a};return a};c.DefineResolveEngine=f.createNamedObject("DefineResolveEngine");c.DefineResolveEngine.create=function(a,b){function e(){m=[];for(var a=p.length,b=t.length,d=0;d<a;d++){var e=p[d];if(e&&!e.resolved){for(var c=[],f=e.dependencies,g=f.length,k=0,l=[],q=0;q<g;q++){for(var r=f[q],n=!1,w=0;w<b;w++){var z=t[w];z.defined&&z.objectPath==r&&(k++,l.push(z.result),n=!0)}n||c.push(r)}k==g?(e.resolved=!0,u("Launching resolve for '"+f.join("', '")+
"'"),h.testCallback(e.handler,l,e.context),v("resolved",{data:e.result}),p.splice(d,1),--d):m.push({emptyDependencies:c})}}}function k(){l=[];for(var b=t.length,d=0;d<b;d++){var c=t[d];if(!c.defined){for(var y=[],q=0,m=c.dependencies,B=m.length,b=t.length,r=[],n=0;n<B;n++){for(var p=m[n],x=!1,A=0;A<b;A++){var w=t[A],z=w.objectPath;w.defined&&z==p&&(q++,r.push(w.result),x=!0)}x||y.push(p)}q==B?(c.defined=!0,u("Resolved definition for '"+c.objectPath+"'"),c.targetPath[c.objectName]&&g(c.objectPath+
" already defined!"),y=h.testCallback(c.handler,r,a),h.isSet(y)||f("Define handler for "+c.objectPath+" does not return anything"),c.result=c.targetPath[c.objectName]=y,v("defined",{data:c.result}),e(),k()):l.push({objectPath:c.objectPath,emptyDependencies:y})}}}var d=b&&a.log||q,g=b&&a.error||q,f=b&&a.warn||q,u=b&&a.mark||q,v=a.dispatch||q,n=a.on||q,h=c.Utils,l=[],m=[],p=[],t=[],r="";a.define=function(b,c,e){if(!h.isString(b))return g("No objectPath passed to define!");r=b;var f=b.split("."),l=f.pop();
if(""==l)return g("define must have objectPath (objectName) argument!");h.isFunction(c)&&(e=c,c=[]);if(!h.isSet(e))return g("No handler to define "+b+"!");for(var q=f.length,m=a,n=0;n<q;n++){var p=f[n];""!=p&&(m[p]=m=m[p]||h.createNamedObject(p))}d("Added definition for '"+b+"'");t.push({defined:!1,objectPath:b,targetPath:m,objectName:l,dependencies:c,handler:e});k();return a};a.defineOn=function(b,c,e,f){d("Added definition on event type '"+b+"' for '"+c+"'");n(b,function(b){a.define(c,e,f)});return a};
a.resolve=function(b,c,g){if(h.isFunction(b))if(g=c,c=b,r)b=[r];else{f("No dependencies for resolve");return}h.isArray(b)||(b=[b]);p.push({resolved:!1,dependencies:b,handler:c,context:h.isSet(g)?g:a});d("Added resolve handler to '"+b.join("', '")+"'");e();return a};a.isDefined=function(a){h.isArray(a)||(a=[a]);for(var b=a.length,c=t.length,d=0,e=0;e<c;e++){var f=t[e];if(f.defined)for(var g=0;g<b;g++)if(a[g]==f.objectPath&&(d++,d==b))return!0}return!1};a.debugDefines=function(){var a=l.length;if(a){f("Empty definitions:");
for(var b=0;b<a;b++){var c=l[b];d(c.objectPath);d("#"+(b+1)+"\t"+c.emptyDependencies.join(", "))}}else u("All definitions ok");if(a=m.length)for(f("Empty resolves:"),b=0;b<a;b++)d("#"+(b+1)+"\t"+m[b].emptyDependencies.join(", "));else u("All resolves ok");return{emptyDefines:l,emptyResolves:m}};return a};c.create=function(a,b,e){a=a||f.getName();e=!!e;var k=c.Utils,d={debug:!!b},g=k.createNamedObject(a,{debug:function(a){k.isSet(a)&&(d.debug=!!a,this.mark("Set debug mode "+(d.debug?"on":"off")));
return d.debug},toggleDebug:function(){return this.debug(!this.debug())}});c.LogEngine.create(g,"["+a+"] ",d);d.debug&&(f.sayHello(),b="Creating instance '"+a+"': debug mode "+((d.debug?"on":"off")+" & "),b+=(e?"skip export":"adding")+" to global context",g.mark(b));c.EventsEngine.create(g,!0).events.register(["resolved","defined","domReady","windowLoaded"],!0);c.DefineResolveEngine.create(g,!0).define("utils",function(){return c.Utils});f.bindDOMReady(function(){g.log("New state: DOM_READY");g.dispatch("domReady")}).bindWindowLoad(function(){g.log("New state: WINDOW_LOADED");
g.dispatch("windowLoaded")});e||(k.isSet(u[a])?g.log(a+" already defined: skipping export to global scope"):(g.mark(a+" added to global scope"),u[a]=g));f.registerInstance(g);return g};c.extend=function(a,b,c){f.addExtension("define",[a,b,c])};v.X=c;v.X.Version="1.005 [13.11.2015]"}})(this);